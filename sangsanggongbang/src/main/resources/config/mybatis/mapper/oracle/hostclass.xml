<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.gr.ssgb.hostclass.model.HostClassDAO">
	<select id="selectCategoryAll" resultType="categoryVo">
	 	select * from category order by category_code
	 </select>
	
	<insert id="insertClass" parameterType="hostClassVo">
		<selectKey keyProperty="cNo" resultType="int" order="BEFORE">
         select HOSTCLASS_SEQ.nextval from dual
      </selectKey>
		
		insert into
		HOSTCLASS(
         C_NO
         , C_NAME
         , CATEGORY_CODE
         , H_NO
         , L_NO
         , C_PRICE
         , PPNUM
         , C_START_TIME
         , C_TIME
         , END_FLAG
         )
		values( #{cNo}
            , #{cName}
            , #{CateCode}  
            , #{hNo}
            , #{lNo}
             , #{cPrice}
             , #{ppnum}
             , #{cStart}
             , #{cTime}
             , #{endFlag}
		)
		
	</insert>
	
	<insert id="insertContents" parameterType="contentsVo">
		<selectKey keyProperty="contentsNo" resultType="int" order="BEFORE">
         select C_CONTENTS_SEQ.nextval from dual
      </selectKey>
		
		insert 
		into C_Contents(
           CONTENTS_NO
           , C_NO
           , THUMBNAIL
           ,CONTENTS_FILENAME1 
           ,CONTENTS_FILENAME2
           ,CONTENTS_FILENAME3 
           ,CONTENTS_FILENAME4 
           ,CONTENTS_FILENAME5
           ,CONTENTS_CONTENT
           )
        values(
              #{contentsNo}
              , #{cNo}
              , #{thumbnail}
              ,#{cFilename1}
              ,#{cFilename2}
              ,#{cFilename3}
              ,#{cFilename4}
              ,#{cFilename5}
              ,#{content}
           )
		
	</insert>

	<insert id="insertLocation" parameterType="locationVo">
		<selectKey keyProperty="lNo" resultType="int" order="BEFORE">
         select LOCATION_SEQ.nextval from dual
      </selectKey>
		insert
		 into Location(
           L_NO
           , ZIPCODE
           , L_ADDRESS
           , L_ADDRESS_DETAIL
           , H_NO
           )
         values(
            #{lNo}
            , #{zipcode}
            , #{lAddress}
            , #{lAddressDetail}
            ,#{hNo}
            )
		
	</insert>

	<select id="selectBylocation" parameterType="locationVo" resultType="locationVo">
		select * from location 
		where h_no=#{hNo} and l_address=#{lAddress} and l_address_detail=#{lAddressDetail}
	</select>
	<select id="selectByLNo" parameterType="locationVo" resultType="int">
		select L_NO from location 
		where l_address_detail=#{lAddressDetail} and l_address=#{lAddress} and h_no=#{hNo}
	</select>
	
	<select id="selectByCNo" parameterType="hostclassVo" resultType="int">
		select C_NO from hostclass where C_START_TIME=#{cStart} and C_TIME=#{cTime}
	</select>
	
	<select id="selectClassAll" resultType="hostClassVo">
		select * from hostclass order by c_end_time desc
	</select>
	
	<select id="selectThumbnail" parameterType="int" resultType="string">
		select thumbnail from c_contents where c_no=#{cNo}
	</select>
	
	<select id="selectClassAllContents" resultType="map">
		select * from selectClass order by c_start_time desc
	</select>
	
	<select id="selectClassLoc" parameterType="string" resultType="map">
		select * from selectClass where loc=#{loc} order by c_start_time desc
	</select>
	
	<select id="selectClassCategory" resultType="map" parameterType="string">
		select * from selectClass where category_name=#{'categoryName'} order by c_start_time desc
	</select>
	
	<select id="selectClassbyCNo" resultType="map" parameterType="int">
		 select * from selectClass where c_no=#{cNo}
	</select>
	<select id="selectClassAllOfHost" resultType="map" parameterType="int">
		select * from selectClass where h_no=#{hNo} order by c_start_time desc
	</select>

	<update id="updateBylocation" parameterType="locationVo">
		update location set 
			zipcode= #{zipcode},l_address=#{lAddress}
			,l_address_detail=#{lAddressDetail} where l_no=#{lNo}
	</update>
	<update id="updateByClass" parameterType="hostClassVo">
		update hostclass set 
			C_NAME= #{cName},CATEGORY_CODE=#{CateCode},
			C_PRICE= #{cPrice}, PPNUM=#{ppnum},
			C_START_TIME=#{cStart},C_TIME=#{cTime} where c_no=#{cNo}
	</update>
	<update id="updateByContents" parameterType="contentsVo">
		update C_Contents set 
			THUMBNAIL= #{thumbnail},CONTENTS_FILENAME1=#{cFilename1},
			CONTENTS_FILENAME2= #{cFilename2}, CONTENTS_FILENAME3=#{cFilename3},
			CONTENTS_FILENAME4=#{cFilename4},CONTENTS_FILENAME5=#{cFilename5},
			CONTENTS_CONTENT=#{content} where c_no=#{cNo}
			
	</update>

	<delete id="deleteClass" parameterType="int">
		delete from hostclass where c_no=#{cNo}
	</delete>

	<delete id="deleteContents" parameterType="int">
		delete from C_Contents where c_no=#{cNo}
	</delete>

	<select id="selectClassCnt" parameterType="int" resultType="int">
		select count(*) from hostclass where h_no = #{hNo}
	</select>
	
	<select id="selectConcernbyCNo" parameterType="concernVo" resultType="int">
		select count(*) from concern where c_no=#{cNo} and m_no=#{mNo}
	</select>
	
</mapper>